# SPDX-FileCopyrightText: Â© 2021 ChiselStrike <info@chiselstrike.com>

# RUN: sh -e @file

$CHISEL webdev &
PID=$!

function cleanup() {
    kill $PID
    wait
}

trap cleanup EXIT

#until $CURL -s localhost:8181; do :; done

$CURL -d '{"endpoint": "export default async function(r) { return new Response(\"success\\n\") }"}' localhost:8181/apply
# CHECK: access-control-allow-origin: *
# CHECK: access-control-allow-methods: POST, PUT, GET, OPTIONS

$CURL localhost:8080/dev/ep1
#CHECK: success
